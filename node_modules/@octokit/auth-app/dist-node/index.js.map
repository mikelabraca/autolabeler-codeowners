{"version":3,"file":"index.js","sources":["../dist-src/get-app-authentication.js","../dist-src/cache.js","../dist-src/to-token-authentication.js","../dist-src/get-installation-authentication.js","../dist-src/get-oauth-authentication.js","../dist-src/auth.js","../dist-src/requires-app-auth.js","../dist-src/hook.js","../dist-src/version.js","../dist-src/index.js"],"sourcesContent":["import { githubAppJwt } from \"universal-github-app-jwt\";\nexport async function getAppAuthentication(id, privateKey) {\n    const appAuthentication = await githubAppJwt({ id, privateKey });\n    return {\n        type: \"app\",\n        token: appAuthentication.token,\n        appId: appAuthentication.appId,\n        expiresAt: new Date(appAuthentication.expiration * 1000).toISOString()\n    };\n}\n","// https://github.com/isaacs/node-lru-cache#readme\nimport LRU from \"lru-cache\";\nexport function getCache() {\n    return new LRU({\n        // cache max. 15000 tokens, that will use less than 10mb memory\n        max: 15000,\n        // Cache for 1 minute less than GitHub expiry\n        maxAge: 1000 * 60 * 59\n    });\n}\nexport async function get(cache, options) {\n    const cacheKey = optionsToCacheKey(options);\n    const result = await cache.get(cacheKey);\n    if (!result) {\n        return;\n    }\n    const [token, expiresAt, repositorySelection, permissionsString, singleFileName] = result.split(\"|\");\n    const permissions = options.permissions ||\n        permissionsString.split(/,/).reduce((permissions, string) => {\n            if (/!$/.test(string)) {\n                permissions[string.slice(0, -1)] = \"write\";\n            }\n            else {\n                permissions[string] = \"read\";\n            }\n            return permissions;\n        }, {});\n    return {\n        token,\n        expiresAt,\n        permissions,\n        repositoryIds: options.repositoryIds,\n        singleFileName,\n        repositorySelection: repositorySelection\n    };\n}\nexport async function set(cache, options, data) {\n    const cacheKey = optionsToCacheKey(options);\n    const permissionsString = options.permissions\n        ? \"\"\n        : Object.keys(data.permissions)\n            .map(name => `${name}${data.permissions[name] === \"write\" ? \"!\" : \"\"}`)\n            .join(\",\");\n    await cache.set(cacheKey, [\n        data.token,\n        data.expiresAt,\n        data.repositorySelection,\n        permissionsString,\n        data.singleFileName\n    ]\n        .join(\"|\")\n        .replace(/\\|+$/, \"\"));\n}\nfunction optionsToCacheKey({ installationId, permissions = {}, repositoryIds = [] }) {\n    const permissionsString = Object.keys(permissions)\n        .sort()\n        .map(name => (permissions[name] === \"read\" ? name : `${name}!`))\n        .join(\",\");\n    const repositoryIdsString = repositoryIds.sort().join(\",\");\n    return [installationId, repositoryIdsString, permissionsString]\n        .filter(Boolean)\n        .join(\"|\");\n}\n","export function toTokenAuthentication({ installationId, token, expiresAt, repositorySelection, permissions, repositoryIds, singleFileName }) {\n    return Object.assign({\n        type: \"token\",\n        tokenType: \"installation\",\n        token,\n        installationId,\n        permissions,\n        expiresAt,\n        repositorySelection\n    }, repositoryIds ? { repositoryIds } : null, singleFileName ? { singleFileName } : null);\n}\n","import { get, set } from \"./cache\";\nimport { getAppAuthentication } from \"./get-app-authentication\";\nimport { toTokenAuthentication } from \"./to-token-authentication\";\nexport async function getInstallationAuthentication(state, options, customRequest) {\n    const installationId = (options.installationId ||\n        state.installationId);\n    if (!options.refresh) {\n        const result = await get(state.cache, options);\n        if (result) {\n            const { token, expiresAt, permissions, repositoryIds, singleFileName, repositorySelection } = result;\n            return toTokenAuthentication({\n                installationId,\n                token,\n                expiresAt,\n                permissions,\n                repositorySelection,\n                repositoryIds,\n                singleFileName\n            });\n        }\n    }\n    const appAuthentication = await getAppAuthentication(state.id, state.privateKey);\n    const request = customRequest || state.request;\n    const { data: { token, expires_at: expiresAt, repositories, permissions, repository_selection: repositorySelection, single_file: singleFileName } } = await request(\"POST /app/installations/:installation_id/access_tokens\", {\n        installation_id: installationId,\n        repository_ids: options.repositoryIds,\n        permissions: options.permissions,\n        mediaType: {\n            previews: [\"machine-man\"]\n        },\n        headers: {\n            authorization: `bearer ${appAuthentication.token}`\n        }\n    });\n    const repositoryIds = repositories\n        ? repositories.map((r) => r.id)\n        : void 0;\n    await set(state.cache, options, {\n        token,\n        expiresAt,\n        repositorySelection,\n        permissions,\n        repositoryIds,\n        singleFileName\n    });\n    return toTokenAuthentication({\n        installationId,\n        token,\n        expiresAt,\n        repositorySelection,\n        permissions,\n        repositoryIds,\n        singleFileName\n    });\n}\n","import { RequestError } from \"@octokit/request-error\";\nexport async function getOAuthAuthentication(state, options, customRequest) {\n    const request = customRequest || state.request;\n    // The \"/login/oauth/access_token\" is not part of the REST API hosted on api.github.com,\n    // instead itâ€™s using the github.com domain.\n    const route = /^https:\\/\\/(api\\.)?github\\.com$/.test(state.request.endpoint.DEFAULTS.baseUrl)\n        ? \"POST https://github.com/login/oauth/access_token\"\n        : `POST ${state.request.endpoint.DEFAULTS.baseUrl.replace(\"/api/v3\", \"/login/oauth/access_token\")}`;\n    const parameters = {\n        headers: {\n            accept: `application/json`\n        },\n        client_id: state.clientId,\n        client_secret: state.clientSecret,\n        code: options.code,\n        state: options.state,\n        redirect_uri: options.redirectUrl\n    };\n    const response = await request(route, parameters);\n    if (response.data.error !== undefined) {\n        throw new RequestError(`${response.data.error_description} (${response.data.error})`, response.status, {\n            headers: response.headers,\n            request: request.endpoint(route, parameters)\n        });\n    }\n    const { data: { access_token: token, scope } } = response;\n    return {\n        type: \"token\",\n        tokenType: \"oauth\",\n        token,\n        scopes: scope.split(/,\\s*/).filter(Boolean)\n    };\n}\n","import { getAppAuthentication } from \"./get-app-authentication\";\nimport { getInstallationAuthentication } from \"./get-installation-authentication\";\nimport { getOAuthAuthentication } from \"./get-oauth-authentication\";\nexport async function auth(state, options) {\n    if (options.type === \"app\") {\n        return getAppAuthentication(state.id, state.privateKey);\n    }\n    if (options.type === \"installation\") {\n        return getInstallationAuthentication(state, options);\n    }\n    return getOAuthAuthentication(state, options);\n}\n","const PATHS = [\n    \"/app\",\n    \"/app/installations\",\n    \"/app/installations/:installation_id\",\n    \"/app/installations/:installation_id\",\n    \"/app/installations/:installation_id/access_tokens\",\n    \"/orgs/:org/installation\",\n    \"/orgs/:org/installation\",\n    \"/repos/:owner/:repo/installation\",\n    \"/repos/:owner/:repo/installation\",\n    \"/users/:username/installation\",\n    \"/users/:username/installation\"\n];\n// CREDIT: Simon Grondin (https://github.com/SGrondin)\n// https://github.com/octokit/plugin-throttling.js/blob/45c5d7f13b8af448a9dbca468d9c9150a73b3948/lib/route-matcher.js\nfunction routeMatcher(paths) {\n    // EXAMPLE. For the following paths:\n    /* [\n        \"/orgs/:org/invitations\",\n        \"/repos/:owner/:repo/collaborators/:username\"\n    ] */\n    const regexes = paths.map(p => p\n        .split(\"/\")\n        .map(c => (c.startsWith(\":\") ? \"(?:.+?)\" : c))\n        .join(\"/\"));\n    // 'regexes' would contain:\n    /* [\n        '/orgs/(?:.+?)/invitations',\n        '/repos/(?:.+?)/(?:.+?)/collaborators/(?:.+?)'\n    ] */\n    const regex = `^(?:${regexes.map(r => `(?:${r})`).join(\"|\")})[^/]*$`;\n    // 'regex' would contain:\n    /*\n      ^(?:(?:\\/orgs\\/(?:.+?)\\/invitations)|(?:\\/repos\\/(?:.+?)\\/(?:.+?)\\/collaborators\\/(?:.+?)))[^\\/]*$\n  \n      It may look scary, but paste it into https://www.debuggex.com/\n      and it will make a lot more sense!\n    */\n    return new RegExp(regex, \"i\");\n}\nconst REGEX = routeMatcher(PATHS);\nexport function requiresAppAuth(url) {\n    return !!url && REGEX.test(url);\n}\n","import { getAppAuthentication } from \"./get-app-authentication\";\nimport { getInstallationAuthentication } from \"./get-installation-authentication\";\nimport { requiresAppAuth } from \"./requires-app-auth\";\nexport async function hook(state, request, route, parameters) {\n    let endpoint = request.endpoint.merge(route, parameters);\n    if (requiresAppAuth(endpoint.url.replace(request.endpoint.DEFAULTS.baseUrl, \"\"))) {\n        const { token } = await getAppAuthentication(state.id, state.privateKey);\n        endpoint.headers.authorization = `bearer ${token}`;\n        return request(endpoint);\n    }\n    const { token } = await getInstallationAuthentication(state, {}, request);\n    endpoint.headers.authorization = `token ${token}`;\n    return request(endpoint);\n}\n","export const VERSION = \"2.4.2\";\n","import { getUserAgent } from \"universal-user-agent\";\nimport { request } from \"@octokit/request\";\nimport { auth } from \"./auth\";\nimport { hook } from \"./hook\";\nimport { getCache } from \"./cache\";\nimport { VERSION } from \"./version\";\nexport const createAppAuth = function createAppAuth(options) {\n    const state = Object.assign({\n        request: request.defaults({\n            headers: {\n                \"user-agent\": `octokit-auth-app.js/${VERSION} ${getUserAgent()}`\n            }\n        }),\n        cache: getCache()\n    }, options);\n    return Object.assign(auth.bind(null, state), {\n        hook: hook.bind(null, state)\n    });\n};\n"],"names":["getAppAuthentication","id","privateKey","appAuthentication","githubAppJwt","type","token","appId","expiresAt","Date","expiration","toISOString","getCache","LRU","max","maxAge","get","cache","options","cacheKey","optionsToCacheKey","result","repositorySelection","permissionsString","singleFileName","split","permissions","reduce","string","test","slice","repositoryIds","set","data","Object","keys","map","name","join","replace","installationId","sort","repositoryIdsString","filter","Boolean","toTokenAuthentication","assign","tokenType","getInstallationAuthentication","state","customRequest","refresh","request","expires_at","repositories","repository_selection","single_file","installation_id","repository_ids","mediaType","previews","headers","authorization","r","getOAuthAuthentication","route","endpoint","DEFAULTS","baseUrl","parameters","accept","client_id","clientId","client_secret","clientSecret","code","redirect_uri","redirectUrl","response","error","undefined","RequestError","error_description","status","access_token","scope","scopes","auth","PATHS","routeMatcher","paths","regexes","p","c","startsWith","regex","RegExp","REGEX","requiresAppAuth","url","hook","merge","VERSION","createAppAuth","defaults","getUserAgent","bind"],"mappings":"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"}